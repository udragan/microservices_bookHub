<div class="flex flex-column align-items-center">
	<p-card [style]="{ width: '40rem' }">
		<div class="flex justify-content-between align-items-center">
			<form [formGroup]="formUpdateAccount" (submit)="saveChanges()" class="flex flex-column gap-4 w-25rem">
				<div class="flex flex-column gap-1">
					<p-floatlabel variant="on">
						<input pInputText id="email" formControlName="email" class="w-full" />
						<label for="email">Email Address</label>
					</p-floatlabel>
				</div>
				<div class="flex flex-column gap-1">
					<p-floatlabel  variant="on">
						<input pInputText id="name" formControlName="name" class="w-full" />
						<label for="name">Name</label>
					</p-floatlabel>
					
					@if (formUpdateAccount.get('name')?.invalid && formUpdateAccount.get('name')?.dirty) {
						<small class="p-error ml-2">Name is required.</small>
					}
				</div>
				<div class="flex flex-column gap-1">
					<p-button [rounded]="true" label="Change password" styleClass="w-full" (onClick)="showChangePasswordDialogSignal.set(true)" />
				</div>

				<div class="flex flex-column p-2 pt-3 border-top-1 surface-border mt-4">
					<p-button type="submit" [rounded]="true" [disabled]="formUpdateAccount.invalid || !formUpdateAccount.dirty" styleClass="w-full" label="Save" />
				</div>
			</form>

			<div class="flex flex-column align-items-center gap-3 pr-4">
				<p-avatar [image]="$any(avatarUrlSignal())" size="xlarge" shape="circle" class="shadow-2" />

				<div class="flex flex-column gap-2">
					<p-fileUpload mode="basic" [customUpload]="true" (uploadHandler)="onUploadAvatar($event)" [auto]="true" chooseLabel="Upload New" />
				</div>
			</div>
		</div>
	</p-card>
</div>

<p-dialog header="Change password" [(visible)]="showChangePasswordDialogSignal" [modal]="true">
	<form [formGroup]="formPasswordChange" (submit)="passwordChange()">
		<div class="flex flex-column gap-4 pt-2">
			<p-floatlabel variant="on">			
				<input id="password" pInputText formControlName="password" class="w-full" />
				<label for="password">Current password</label>
			</p-floatlabel>
			<p-floatlabel variant="on">			
				<input id="newPassword" pInputText formControlName="newPassword" class="w-full" />
				<label for="newPassword">New password</label>
			</p-floatlabel>
			<p-floatlabel variant="on">			
				<input id="newPasswordRepeat" pInputText formControlName="newPasswordRepeat" class="w-full" />
				<label for="role">Retype new password</label>
			</p-floatlabel>
		</div>
		<div class="flex justify-content-end gap-2 pt-3 border-top-1 surface-border mt-4">
			<p-button type="submit" [rounded]="true" class="flex flex-column w-full" label="Change" />
		</div>
	</form>
</p-dialog>

<p-toast pRipple position="bottom-right" />
